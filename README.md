
# 📘 R-practice

---
# 📘 R 言語 学習記録

## 🔍 概要
このリポジトリでは、統計解析やデータ可視化のための R 言語の学習を記録しています。  
基本文法から、`dplyr` や `ggplot2` などの主要ライブラリ、そして簡単なデータサイエンスの実装までを目指します。

## 🛠 使用ツール
- R 4.x
- RStudio (ローカル or 仮想環境)
- GitHub / Git
- [Google Colab (R対応)](https://colab.research.google.com/)（必要に応じて）

## ✅ 学習内容
- [x] 変数と演算子
- [x] データ型（numeric, character, factor）
- [x] データフレームの作成と操作
- [ ] グラフ描画（`ggplot2`）
- [ ] モデル構築（回帰・分類）

## 📁 フォルダ構成
```

R/
├── basics.R            # 基本文法
├── dataframe\_ex.R      # データフレームの操作
└── README.md           # このファイル

```

## ✍️ メモ
- `a <- 1` のように <- を代入に使うのがRの特徴。
- データ可視化の自由度が高く、きれいなグラフが描ける。
以下は、読みやすく整理し直した **R学習記録用のREADME.md形式** です。表の表示や改行を整え、MarkdownとしてGitHub上で見やすくなるように調整しました。

---



## 🧪 練習1：Hello World の出力

`print` 関数を使って、文字列 `"Hello World!"` を出力します。

```r
print("Hello World!")
````

> コンソールに `Hello World!` と表示されるはずです。
> コンソールをクリアしたい場合は、`Ctrl` + `L` を押してください。

---

## 🧪 練習2：変数の代入と加算

以下のコードを実行すると、変数に値を代入し、加算結果を得られます。

```r
x <- 1  
y <- 2  
z <- x + y
```

---

### ✅ 基本操作の解説（R）

| コード      | 意味               | 結果         |
| -------- | ---------------- | ---------- |
| `a <- 1` | 変数 `a` に 1 を代入する | ―（代入のみ）    |
| `a + 2`  | `a` に 2 を足して表示する | `3`（1 + 2） |

---

### ✅ PythonとRの算術演算の比較

| 操作内容    | Pythonの書き方               | Rの書き方                 | 結果    |
| ------- | ------------------------ | --------------------- | ----- |
| 足し算     | `1 + 2`                  | `1 + 2`               | `3`   |
| 引き算     | `5 - 3`                  | `5 - 3`               | `2`   |
| 掛け算     | `4 * 2`                  | `4 * 2`               | `8`   |
| 割り算     | `8 / 2`                  | `8 / 2`               | `4.0` |
| 整数除算    | `8 // 3`                 | `8 %/% 3`             | `2`   |
| 剰余（あまり） | `8 % 3`                  | `8 %% 3`              | `2`   |
| 累乗（べき乗） | `2 ** 3` または `pow(2, 3)` | `2^3` または `pow(2, 3)` | `8`   |

---

## 🧪 練習3：環境パネルでの Rオブジェクトの確認

以下のコードをコンソールで入力・実行してください：

```r
x <- 1  
y <- 2  
z <- x + y
```

> RStudio の「環境パネル」に `x`, `y`, `z` の値が表示されます。

---

## 🧪 練習4：最初のRスクリプトファイルの作成

### 🔹 手順

1. **File > New File > R Script** を選択
2. **File > Save** をクリックし、ファイル名を `first_script.R` に設定
3. 以下のコードを入力：

```r
x <- 3
y <- 4
z <- x + y
print(z)
```

> ※ 最後に Enter を押して新しい空行を作るのを忘れずに！

---

### 🔹 実行方法

* **選択した行だけ実行**：行を選択し、`Run` アイコンをクリック
* **ファイル全体を実行**：`Source` アイコンをクリック

```r
source('first_script.R')
```

実行結果：

```
[1] 7
```

---

✅ これで、Rスクリプトの作成と実行方法の基本をマスターしました！

---

グラフについて


| グラフの種類 | コード例                         | 解説     |
| ------ | ---------------------------- | ------ |
| 散布図    | `geom_point()`               | 点で表現   |
| 棒グラフ   | `geom_bar()` or `geom_col()` | カテゴリごと |
| 折れ線グラフ | `geom_line()`                | 時系列や傾向 |
| 箱ひげ図   | `geom_boxplot()`             | 分布と外れ値 |
| ヒストグラム | `geom_histogram()`           | 頻度分布   |

---
ヒント：おすすめのデータセット（Kaggle内）

titanic（生存分析に棒グラフなど）

iris（有名な花のデータ、散布図などに最適）

penguins（カテゴリ別プロットにぴったり）

---

| 列名   | 説明              |
| ---- | --------------- |
| mpg  | 燃費（mile/gallon） |
| wt   | 重さ（1000ポンド単位）   |
| cyl  | シリンダー数          |
| gear | ギア数             |

---

| パッケージ名    | 主な用途・特徴                                             |
| --------- | --------------------------------------------------- |
| `ggplot2` | 最も基本的な視覚化パッケージ。棒グラフ、ヒストグラム、散布図など。レイヤー構造でカスタマイズ可能。   |
| `plotly`  | Webベースでインタラクティブなグラフ作成。HTMLファイルで保存・共有も可能。            |
| `lattice` | 多変量（複数変数）データの視覚化に便利。複数のグラフを並べるパネル機能が強い。             |
| `leaflet` | 地図ベースの可視化。位置情報やマップのインタラクションに強い。                     |
| `GGally`  | `ggplot2`の拡張。散布図行列など複雑なプロットが簡単に作れる。`ggpairs()` が有名。 |


---

| 引数           | 意味          |
| ------------ | ----------- |
| `type="l"`   | 線（line）を描く  |
| `main="..."` | グラフのタイトルを表示 |

---

| 関数/引数          | 目的                           |
| -------------- | ---------------------------- |
| `ggplot()`     | グラフの土台（どのデータ、どの軸を使うか指定）      |
| `aes()`        | aesthetic（美的属性）＝ x軸・y軸の変数を指定 |
| `geom_point()` | 散布図を描画                       |
| `ggtitle()`    | グラフのタイトルを追加                  |
| `labs()`       | x軸・y軸の名前、説明をつける              |

---

ggpairs()：散布図、ヒストグラム、相関を組み合わせた散布図行列を自動生成。

mtcars[, 1:3]：mtcarsデータセットの最初の3列を使用

---

R には可視化のための多くのパッケージがある（ggplot2, plotly, leaflet など）

基本の plot() 関数でもプロットできる

ggplot2 を使えば、軸、タイトル、スタイルを細かく調整可能

GGally を使えば、多変量の関係性も一目でわかる

---

dplyrとはなんですか？

`dplyr` は、**R 言語でデータを効率的に操作するためのパッケージ**です。
データフレーム（表形式のデータ）を **見やすく、簡単に処理できる**ように設計されています。

---

## 🔍 特徴

* **読みやすく、書きやすい文法**
* **データの抽出・並べ替え・集計などがシンプルに書ける**
* `pipe演算子（%>%）` を使ってコードをつなげて書ける

---

## 🛠️ よく使う関数（5つの基本）

| 関数            | 役割            | 例                          |
| ------------- | ------------- | -------------------------- |
| `filter()`    | 条件で行を絞る       | `filter(データ, 年齢 > 30)`     |
| `select()`    | 列を選ぶ（または除く）   | `select(データ, 名前, 年齢)`      |
| `mutate()`    | 新しい列を作る（計算など） | `mutate(収入_税後 = 収入 * 0.8)` |
| `arrange()`   | 並べ替え（昇順・降順）   | `arrange(データ, 年齢)`         |
| `summarise()` | 集計（平均・合計など）   | `summarise(平均 = mean(年齢))` |
| `group_by()`  | グループ別に操作する    | `group_by(性別)` と組み合わせる     |

---

## ✨ 例（mtcarsデータを使って）

```r
library(dplyr)

# 重さが 3 より大きい車を選び、mpg（燃費）の平均を計算
mtcars %>%
  filter(wt > 3) %>%
  summarise(平均燃費 = mean(mpg))
```

---

## 💡 まとめ

| 用途       | `dplyr` の便利さ        |
| -------- | ------------------- |
| データ選択    | 行や列を簡単に選べる          |
| データ変形    | 新しい列を追加・変換できる       |
| データ集計    | グループごとの平均・合計も簡単     |
| 読みやすいコード | `%>%` を使って自然な流れに書ける |

---

📌「Excel で行っていた操作を、R でスッキリ書けるようにする」ようなパッケージです。

---

`%>%` は \*\*R の dplyr パッケージなどで使われる「パイプ演算子」\*\*です。
意味は：

> 「結果を次の関数へ渡す」

つまり、**関数をつなげて書ける**ので、コードがスッキリ・読みやすくなります。

---

## 🔧 基本的な使い方

```r
データ %>% 関数1() %>% 関数2()
```

これはこういう意味です：

```r
関数2(関数1(データ))
```

---

## 💡 例（`mtcars` データを使って）

```r
library(dplyr)

# mtcars の中から mpg > 20 の車を選び、mpgの平均を計算する
mtcars %>%
  filter(mpg > 20) %>%
  summarise(平均燃費 = mean(mpg))
```

↑これは次のようにも書けますが、読みづらくなります：

```r
summarise(filter(mtcars, mpg > 20), 平均燃費 = mean(mpg))
```

---

## 🔄 人間の思考の順番で書ける

パイプ演算子 `%>%` を使うと：

* まず「どのデータ？」
* 次に「どんな条件？」
* 最後に「どうまとめる？」

という **上から下への流れ**で書けるので、自然でわかりやすいです。

---

## ✅ 覚えておきたいポイント

| 記号    | 意味                     |
| ----- | ---------------------- |
| `%>%` | パイプ：左の結果を右の関数に渡す       |
| `.`   | パイプ内でデータを明示するときに使う（上級） |

---

## ✍️ おまけ：パイプがないときとの比較

**パイプあり（%>% 使用）**

```r
df %>%
  filter(age > 30) %>%
  select(name, age)
```

**パイプなし（ネストが多い）**

```r
select(filter(df, age > 30), name, age)
```

---


---

## ✅ この演習の目的

* `ggplot2` パッケージを使って基本的なグラフを作成する方法を学ぶ
* `mtcars` データセットの可視化を通じて、**散布図・ボックスプロット・ヒストグラム** を描く
* 軸のラベルやタイトルをカスタマイズして、見やすく伝わるグラフを作成する

---

## 🔧 使用するコードとその意味（ポイント付き）

### ① データの読み込みと確認

```r
library(datasets)       # datasetsパッケージを読み込み
data(mtcars)            # mtcarsデータセットを読み込む
head(mtcars, 5)         # 最初の5行を表示
```

🧠 `mtcars` はRに最初から入っているデータ。自動車のスペック（燃費、重量、馬力など）が入っています。

---

### ② `ggplot2` パッケージを使った散布図

```r
library(ggplot2)

ggplot(aes(x=disp, y=mpg), data=mtcars) + 
  geom_point()
```

🧠 **disp**（排気量）と **mpg**（燃費）の関係を見る散布図
→ `geom_point()` が **点（scatter plot）** を描きます。

---

### ③ グラフにタイトルを追加

```r
+ ggtitle("displacement vs miles per gallon")
```

🧠 `ggtitle()` を使ってグラフ上部に説明を追加。

---

### ④ 軸の名前を変更

```r
+ labs(x = "Displacement", y = "Miles per Gallon")
```

🧠 `labs()` は **x軸・y軸のラベル** を設定できます。

---

### ⑤ ボックスプロットの作成（vs別に燃費を比較）

```r
mtcars$vs <- as.factor(mtcars$vs)  # vsをカテゴリ変数に変換

ggplot(aes(x=vs, y=mpg), data=mtcars) + 
  geom_boxplot()
```

🧠 vsはエンジン型（0=V型, 1=直列）
→ **mpg（燃費）** の分布を **エンジン型ごと** に表示。

---

### ⑥ 色付きボックスプロット + 凡例非表示

```r
ggplot(aes(x=vs, y=mpg, fill = vs), data = mtcars) + 
  geom_boxplot(alpha=0.3) + 
  theme(legend.position="none")
```

🧠 `fill = vs` で色分け、`alpha=0.3` で透明度調整
→ `theme()` で凡例（legend）を非表示

---

### ⑦ ヒストグラム（wt: 車の重量）

```r
ggplot(aes(x=wt), data=mtcars) + 
  geom_histogram(binwidth=0.5)
```

🧠 `wt`（weight）に基づいたヒストグラム
→ `binwidth=0.5` で棒の幅を設定

---

## 🧪 このラボを通じて得られること

| 学べること          | 詳細                               |
| -------------- | -------------------------------- |
| `ggplot2` の使い方 | `ggplot() + geom_...()` の構造が身につく |
| 軸やタイトルの変更      | `labs()` と `ggtitle()` を組み合わせる   |
| データの型変換        | `as.factor()` を使ってカテゴリ変数に変換      |
| 視覚的に意味のある色付け   | `fill=` や `alpha=` でグラフを強調       |
| 基本的な統計グラフの種類   | 散布図・ボックスプロット・ヒストグラムの違い           |

---

## 💬 おすすめ：この後のステップ

* 他の変数を使ってプロットを試してみましょう（`hp`, `wt`, `gear`など）
* `facet_wrap()` でカテゴリごとの分割グラフを作る
* `theme_minimal()` などテーマ変更で見た目をカスタマイズ

---

---

## 🎯 演習の目的

* R の `iris` データセットを使って、`ggplot2` の拡張パッケージ **`GGally`** の `ggpairs()` 関数を利用
* データの**変数間の関係性**や**相関関係**を視覚的に一目で確認できるプロットを作成
* プロットの要素（散布図・相関係数・分布図）を理解する

---

## 🧩 1. 必要なパッケージのインストール

以下のコマンドは、依存関係も含めて手動で特定の古いバージョンのパッケージをインストールするものです（通常は不要ですが、特定環境では必要な場合もあります）。

```r
install.packages("https://cran.r-project.org/src/contrib/Archive/patchwork/patchwork_1.1.0.tar.gz", repos = NULL, type = "source", dependencies = TRUE)
install.packages("https://cran.r-project.org/src/contrib/Archive/broom.helpers/broom.helpers_1.4.0.tar.gz", repos = NULL, type = "source", dependencies = TRUE)
install.packages("https://cran.r-project.org/src/contrib/Archive/ggstats/ggstats_0.5.0.tar.gz", repos = NULL, type = "source", dependencies = TRUE)
```

> ⚠️ 通常は `install.packages("GGally")` だけで十分です。

---

## 🧪 2. `iris` データセットの読み込み

```r
library(datasets)
data(iris)
```

🌼 `iris` は、3種類のアヤメの花（Setosa, Versicolor, Virginica）の花びら・がくの長さ/幅データを含む組み込みデータセットです。

---

## 📦 3. `GGally` の読み込みと `ggpairs()` の実行

```r
library(GGally)
ggpairs(iris, mapping=ggplot2::aes(colour = Species))
```

### ✅ `ggpairs()` でできること：

* **対角線上**：各変数の**分布図**（ヒストグラム）
* **対角線の下**：変数同士の**散布図**（相関関係を視覚化）
* **対角線の上**：変数同士の**相関係数**
* **色分け**：Species によって色分けされ、比較しやすい

---

## 🔍 4. プロットの見方

* `Sepal.Length` と `Sepal.Width` の関係を見ると、**Setosa** がはっきり他の種と違うことがわかる
* 相関係数が `1` に近い → 強い相関（例えば `Petal.Length` と `Petal.Width`）
* **分類問題のヒント**にもなる（教師あり学習に使える）

---

## 📊 今後の応用

このようなプロットは、以下に活用されます：

| 活用シーン                   | 説明                    |
| ----------------------- | --------------------- |
| EDA（探索的データ分析）           | データのパターンや傾向を事前に把握     |
| 特徴選択（Feature Selection） | 相関が高すぎる特徴を減らす判断材料に    |
| モデル理解                   | 可視化により、分類や回帰の前に関係性を把握 |

---

## 💡補足：Zoom で拡大

RStudioのプロットウィンドウの右上にある「Zoom」ボタンをクリックすると、大きく見やすい表示になります。

---

## ✅ まとめ

* `GGally::ggpairs()` は、データの全体像を一気に可視化するための**強力な関数**
* 学習中のデータサイエンティストには必須級
* `iris` のような小規模な分類データセットとの相性が抜群

---





